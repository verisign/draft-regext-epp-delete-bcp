<?xml version="1.0" encoding="utf-8"?>
<?xml-model href="rfc7991bis.rnc"?>
<!-- <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?> -->
<!DOCTYPE rfc [
    <!ENTITY nbsp "&#160;">
    <!ENTITY zwsp "&#8203;">
    <!ENTITY nbhy "&#8209;">
    <!ENTITY wj "&#8288;">
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<?rfc tocInclude="yes"?>
<?rfc tocDepth="7"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc
    xmlns:xi="http://www.w3.org/2001/XInclude"
    category="bcp"
    docName="draft-hollenbeck-regext-epp-delete-bcp-02"
    ipr="trust200902"
    obsoletes=""
    updates=""
    submissionType="IETF"
    xml:lang="en"
    version="3"
    consensus="true"
>
    <front>
        <title abbrev="Domain and Host Object Deletion in EPP">Best Practices for Deletion of Domain
            and Host Objects in the Extensible Provisioning Protocol (EPP)</title>
        <author initials="S." surname="Hollenbeck" fullname="Scott Hollenbeck">
            <organization>Verisign Labs</organization>
            <address>
                <postal>
                    <street>12061 Bluemont Way</street>
                    <city>Reston</city>
                    <region>VA</region>
                    <code>20190</code>
                    <country>USA</country>
                </postal>
                <email>shollenbeck@verisign.com</email>
                <uri>https://www.verisignlabs.com/</uri>
            </address>
        </author>

        <author initials="W." surname="Carroll" fullname="William Carroll">
            <organization>Verisign</organization>
            <address>
                <postal>
                    <street>12061 Bluemont Way</street>
                    <city>Reston</city>
                    <region>VA</region>
                    <code>20190</code>
                    <country>USA</country>
                </postal>
                <phone>+1 703 948-3200</phone>
                <email>wicarroll@verisign.com</email>
                <uri>https://verisign.com</uri>
            </address>
        </author>

        <author initials="G." surname="Akiwate" fullname="Gautam Akiwate">
            <organization>Stanford University</organization>
            <address>
                <postal>
                    <street>450 Jane Stanford Way</street>
                    <city>Stanford</city>
                    <region>CA</region>
                    <code>94305</code>
                    <country>USA</country>
                </postal>
                <phone>+1 650 723-2300</phone>
                <email>gakiwate@cs.stanford.edu</email>
                <uri>https://cs.stanford.edu/~gakiwate/</uri>
            </address>
        </author>

        <date />
        <area>Applications</area>
        <workgroup>REGEXT Working Group</workgroup>
        <keyword>EPP</keyword>
        <abstract>
            <t>The Extensible Provisioning Protocol (EPP) includes commands for clients to delete
                domain and host objects, both of which are used to publish information in the Domain
                Name System (DNS). EPP includes guidance concerning those deletions that is intended
                to avoid DNS resolution disruptions and maintain data consistency. However,
                operational relationships between objects can make that guidance difficult to
                implement. Some EPP clients have developed operational practices to delete those
                objects that have unintended impacts on DNS resolution and security. This document
                describes best practices to delete domain and host objects that reduce the risk of
                DNS resolution failure and maintain client-server data consistency.</t>
        </abstract>
    </front>
    <middle>
        <section title="Introduction">
            <t>Section 3.2.2 of RFC 5731 <xref target="RFC5731" /> contains text that has led some
                domain name registrars (acting as EPP clients) to adopt an operational practice of
                re-naming name server host objects so that they can delete domain objects:</t>
            <t>"A domain object SHOULD NOT be deleted if subordinate host objects are associated
                with the domain object. For example, if domain "example.com" exists and host object
                "ns1.example.com" also exists, then domain "example.com" SHOULD NOT be deleted until
                host "ns1.example.com" has either been deleted or renamed to exist in a different
                superordinate domain."</t>
            <t>Similarly, Section 3.2.2 of RFC 5732 <xref target="RFC5732" /> contains this text
                regarding deletion of host objects:</t>
            <t>"A host name object SHOULD NOT be deleted if the host object is associated with any
                other object. For example, if the host object is associated with a domain object,
                the host object SHOULD NOT be deleted until the existing association has been
                broken. Deleting a host object without first breaking existing associations can
                cause DNS resolution failure for domain objects that refer to the deleted host
                object."</t>
            <t>These recommendations create a dilemma when the sponsoring client for "example.com"
                intends to delete "example.com" but its associated host object "ns1.example.com" is
                also associated with domain objects sponsored by another client. It is advised not
                to delete the host object due to its associated domain objects. However, the
                associated domain objects cannot be directly updated because they are sponsored by
                another client. This situation affects all EPP operators that have implemented
                support for host objects.</t>
            <t>Section 3.2.5 of RFC 5732 <xref target="RFC5732" /> describes host object renaming:</t>
            <t>"Host name changes can have an impact on associated objects that refer to the host
                object. A host name change SHOULD NOT require additional updates of associated
                objects to preserve existing associations, with one exception: changing an external
                host object that has associations with objects that are sponsored by a different
                client. Attempts to update such hosts directly MUST fail with EPP error code 2305.
                The change can be provisioned by creating a new external host with a new name and
                any needed new attributes, and subsequently updating the other objects sponsored by
                the client."</t>
            <t>Section 1.1 of RFC 5732 includes a description of external hosts. Note that the
                specific
                method used to rename the host object can create DNS delegation failures and
                introduce
                risks of loss of management control. If the new external host refers
                to an unregistered domain, then a malicious actor may register the domain and create
                the
                host object to gain control of DNS resolution for the domain previously associated
                with
                "ns1.example.com". If the new external host offers an authoritative DNS service but
                the domain is not assigned to an account, then a malicious actor may add the domain
                to a
                service account and gain control of (hijack) DNS resolution functionality. If the
                new external host
                offers recursive DNS service or no DNS service, then DNS requests for the domain
                will result in SERVFAIL messages or other errors. Aggressive re-queries by DNS
                resolvers may then create large numbers of spurious DNS queries for an unresolvable
                domain. Note that renaming a host object to a name of an external host is an
                operation
                that might not be possible to reverse.</t>
            <t>This document describes the rationale for the "SHOULD NOT be deleted" text, the risk
                associated with host object renaming, and the best practices that can be used to
                mitigate that risk.</t>
        </section>
        <section title="Conventions Used in This Document">
            <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
                NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are
                to be interpreted as described in BCP 14 <xref target="RFC2119" /> <xref
                    target="RFC8174" /> when, and only when, they appear in all capitals, as shown
                here.</t>
        </section>
        <section anchor="rationale" title='Rationale for "SHOULD NOT be deleted"'>
            <section anchor="dns-cons" title="DNS Considerations">
                <t>The primary consideration when deleting domain and host objects concerns the
                    potential impact on DNS resolution. Deletion of a domain object will make all
                    name servers associated with subordinate host objects unresolvable. Deletion of
                    a host object will make any domain that has been delegated to the associated
                    name server unresolvable. The text in RFCs 5731 and 5732 was written to
                    encourage clients to take singular, discrete steps to delete objects in a way
                    that avoids breaking DNS resolution functionality. Additionally, allowing host
                    objects to exist after deletion of their superordinate domain object invites
                    hijacking, as a malicious actor may re-register the domain object, potentially
                    controlling resolution for the host objects and for their associated domain
                    objects.</t>
                <section anchor="dns-glue" title="Impact of Glue Policies">
                <t>Glue policies enforced at EPP servers also impact considerations of deleting
                    domain and host objects. A common policy, also referred to
                    as the "wide" glue policy, allows publishing of glue records
                    for any name server residing in the same EPP zone. For
                    instance, an EPP client can publish A/AAAA records for an
                    existing delegation ns3.example.com even if the
                    superordinate domain object example.com is not delegated to
                    it. The existence of these glue records was one rationale to
                    prohibit deletion of domain objects with linked subordinate
                    host objects, since the domains using ns3.example.com may
                    rely on the glue records provided by the EPP server.</t>
                <t>To prevent this dependence, EPP servers can adopt a more restrictive glue
                    policy, also referred to as a "narrow" glue policy,
                    wherein only glue records for host objects that are in the NS object set for the
                    superordinate domain are published. For
                    instance, an EPP client can only publish A/AAAA records for ns3.example.com if
                    and only if example.com is delegated to it. The more restrictive glue policy
                    can reduce the need for deleting host objects.</t>
                </section>
            </section>
            <section anchor="client-server-cons" title="Client-Server Consistency Considerations">
                <t>A server that implicitly deletes subordinate host objects in response to a
                    request to delete a domain object can create a data inconsistency condition in
                    which the EPP client and the EPP server have different views of what remains
                    registered after processing a &lt;delete&gt; command. The text in RFCs 5731 and
                    5732 was written to encourage clients to take singular, discrete steps to delete
                    objects in a way that maintains client-server data consistency.</t>
            </section>
            <section anchor="relational-cons" title="Relational Consistency Considerations">
                <t>Implementations of EPP can have dependencies on the hierarchical domain
                    object/host object relationship, as can exist in a relational database. In such
                    instances, deletion of a domain object without addressing the existing
                    subordinate host objects can cause relational consistency and integrity issues.
                    The text in RFCs 5731 and 5732 was written to reduce the risk of these issues
                    arising as a result of implicit object deletion.</t>
            </section>
        </section>
        <section anchor="renaming-risk" title="Host Object Renaming Risk">
            <t>As described in RFC 5731, it's possible to delete a domain object that has associated
                host objects that are managed by other clients by renaming the host object to exist
                in a different superordinate domain. This is commonly required when the sponsoring
                client is unable to disassociate a host object from a domain object managed by
                another client because only the second client is authorized to make changes to their
                domain object and the EPP server requires host object disassociation to process a
                request to delete a domain object. For example:</t>
            <t>Domain object "domain1.example" is registered by ClientX.</t>
            <t>Domain object "domain2.example" is registered by ClientY.</t>
            <t>Subordinate host object "ns1.domain1.example" is registered by ClientX.</t>
            <t>Host object "ns1.domain1.example" is associated with domain object "domain1.example"
                by
                ClientX.</t>
            <t>Host object "ns1.domain1.example" is associated with domain object "domain2.example"
                by
                ClientY.</t>
            <t>ClientX wishes to delete domain object "domain1.example". It can modify domain object
                "domain1.example" to remove the association of host object "ns1.domain1.example",
                but
                ClientX cannot remove the association of host object "ns1.domain1.example" from
                domain
                object "domain2.example" because "domain2.example" is sponsored by ClientY and
                ClientX is unable to determine that relationship. Only ClientY can
                modify domain object "domain2.example", and if they do not do so ClientX will need
                to
                rename host object "ns1.domain1.example" so that "domain1.example" can be deleted.</t>
            <t>ClientX renames host object "ns1.domain1.example" to "ns1.example.org", creating an
                external host and meeting the EPP server's subordinate host object disassociation
                requirement.</t>
            <t>If domain "example.org" does not exist, this practice introduces a risk of DNS
                resolution hijacking if someone were to register the "example.org" domain and create
                a subordinate
                host object named "ns1.example.org". That name server would receive DNS queries for
                all domains delegated to it, allowing the operator of the name server to respond in
                potentially malicious ways.</t>
        </section>
        <section anchor="practice-analysis"
            title="Analysis of Practices for Domain and Host Object Deletion">
            <t>Different EPP servers can employ a range of practices for domain
                and host object deletion. Notably, the scope of any practice
                discussed here is the EPP server that adopts the practice and the
                domains managed by it. </t>
            <section anchor="renaming-external"
                title="Renaming to External, Presumed Non-Existent Hosts">
                <t>As described above, this practice renames subordinate host objects to an
                    external host in order to allow the deletion of the superordinate domain object.
                    The
                    external host is presumed to be non-existent by the deleting EPP client but
                    no check for existence is typically performed.
                    This practice has been observed in use.
                </t>
                <section anchor="renaming-external-pros" title="Practice Benefits">
                    <t>The primary benefit is convenience for the deleting EPP client. The deleting
                        EPP client is
                        not required to
                        maintain an authoritative DNS service or receive traffic.</t>
                </section>
                <section anchor="renaming-external-cons" title="Practice Detriments">
                    <t>Malicious actors have registered these parent domains and
                        created child host objects to take control of DNS resolution
                        for associated domains <xref target="risky-bizness" />.</t>
                    <t>Sponsoring clients of the associated domains are not informed of the change.
                        Associated domains may no longer resolve if all their hosts are renamed.
                        Associated domains may still resolve if they continue to be associated with
                        existent hosts, in which case their partial vulnerability to hijacking is
                        more difficult to detect.</t>
                </section>
            </section>
            <section anchor="renaming-special-use" title="Renaming to Special Use TLD">
                <t>Clients may rename host objects to a special use TLD that cannot resolve in the DNS. Several variations have been suggested.
                    This practice has not been observed in use.</t>
                <section anchor="renaming-special-use-reserved" title="Renaming to Reserved TLD">
                    <t>Clients may rename host objects to use ".invalid" or
                        another reserved special-use (<xref target="RFC6761" />) TLD
                        as suggested in <xref target="risky-bizness" />.</t>
                    <section anchor="renaming-special-use-reserved-pros" title="Practice Benefits">
                        <t>The primary benefit is convenience for the deleting
                            EPP client. These TLDs are already reserved and will not
                            resolve. The deleting EPP client is not required to
                            maintain an authoritative DNS service or receive
                            traffic. Dependent domains cannot be hijacked.</t>
                    </section>
                    <section anchor="renaming-special-use-reserved-cons" title="Practice Detriments">
                        <t>These TLDs are reserved for experimentation or
                        testing. Their use is confusing and does not signal the
                        client's intent. Their use may be prevented by
                        policy.</t> 
                    </section>
                </section>

                <section anchor="renaming-special-use-alt" title="Renaming to Pseudo-TLD">
                    <t>Clients may rename host objects to use ".alt" or another non-DNS pseudo-TLD as suggested in <xref target="risky-bizness-irtf" />.</t>
                    <section anchor="renaming-special-use-alt-pros" title="Practice Benefits">
                        <t>The primary benefit is convenience for the deleting
                            EPP client. The deleting EPP client is not required to
                            maintain an authoritative DNS service or receive
                            traffic. Dependent domains cannot be hijacked through
                            the registration of these identifiers and delegation in
                            the DNS.  </t>
                    </section>
                    <section anchor="renaming-special-use-alt-cons" title="Practice Detriments">
                        <t>The ".alt" pseudo-TLD is to be used "to signify that this is an alternative
                            (non-DNS) namespace and should not be looked up in a DNS context" <xref
                                target="RFC9476" />. Some EPP servers may restrict TLDs to valid
                            IANA-delegated TLDs. These entries would mix DNS and non-DNS protocols, risk
                            name collisions, create confusion, and potentially result in unpredictable
                            resolver behaviors. These identifiers may be registered in non-DNS
                            namespaces, potentially leading to hijacking vulnerabilities based in other
                            systems. </t>
                    </section>

                </section>

            </section>
            <section anchor="renaming-non-provisioned" title="Renaming to Non-Authoritative Hosts">
                <t>Some domain registrars, acting as EPP clients, have maintained host objects
                    with glue records pointing to prominent public recursive DNS services.
                    This practice has been observed in use.
                </t>
                <section anchor="renaming-non-provisioned-pros" title="Practice Benefits">
                    <t>The primary benefit is convenience for the deleting EPP client. The deleting
                        EPP client is
                        not required to
                        maintain an authoritative DNS service or receive traffic. </t>
                </section>
                <section anchor="renaming-non-provisioned-cons" title="Practice Detriments">
                    <t> Queries for the associated domains result in SERVFAIL or other failure
                        responses. Some recursive name server implementations may aggressively
                        re-query for these responses, potentially resulting in large numbers of
                        queries for unresolvable domains <xref
                            target="I-D.ietf-dnsop-caching-resolution-failures" />.</t>
                </section>
            </section>
            <section anchor="renaming-as112" title='Renaming to "as112.arpa"'>
                <t>Some domain registrars, acting as EPP clients, have rename host objects
                    to subdomains of "as112.arpa," such as "empty.as112.arpa" <xref
                        target="risky-bizness-irtf" />.
                    This practice has been observed in use.
                </t>
                <section anchor="renaming-as112-pros" title="Practice Benefits">
                    <t>
                        The primary benefit is convenience for the deleting EPP client. The deleting
                        EPP client is
                        not required to
                        maintain an authoritative DNS service or receive traffic. These subdomains
                        are
                        valid DNS names designed to sinkhole traffic.
                    </t>
                </section>
                <section anchor="renaming-as112-cons" title="Practice Detriments">
                    <t> This is a misuse of AS112, which is for reverse lookups on non-unique IPs,
                        primarily so local admins can sinkhole non-global traffic <xref
                            target="RFC7535" />. Unexpected AS112 traffic has previously caused
                        problems with intrusion detection systems and firewalls <xref
                            target="RFC6305" />. Local administrators can potentially hijack
                        requests. AS112 infrastructure must be maintained. </t>
                </section>
            </section>
            <section anchor="control-rename"
                title="Renaming to a Host Object Maintained by the Client">
                <t> Deleting EPP clients rename host objects to a sacrificial name server host
                    object maintained by the client. The sacrificial name server should run a DNS
                    resolution service capable of responding with an authoritative non-error,
                    non-failure response for requests made for associated domains. 
                    This practice has been observed in use.
                </t>
                <section anchor="control-rename-pros" title="Practice Benefits">
                    <t> Associated domains are not able to be hijacked, remain in the zone, and have
                        valid DNS records and a responsive DNS service. The service may provide
                        responses that indicate problems with a domain's delegation, such as
                        non-existence or include controlled interruption IP addresses <xref
                            target="RFC8023" />. </t>
                </section>
                <section anchor="control-rename-cons" title="Practice Detriments">
                    <t>This requires that the client maintain the registration of the sacrificial
                        name server's superordinate domain. The client may consider long
                        registration periods and the use of registrar and registry lock services to
                        maintain and protect the superordinate domain and the host object. Failures
                        to maintain these registrations have allowed domain hijacks <xref
                            target="risky-bizness" />. </t>
                </section>
            </section>
            <section anchor="new-service" title="Community Sacrificial Name Server Service">
                <t>A new community-wide service could be created explicitly intended for use for
                    renaming host records. This would require maintenance of name servers capable of
                    authoritatively responding with NXDOMAIN or a controlled interruption IP
                    addresses <xref target="RFC8023" /> for all queries without delegating domains
                    or records. This service could use a new special-use TLD created either through
                    ICANN or IETF processes (e.g., ".sacrificial"), as an IAB request that IANA
                    delegate a second-level domain (SLD) for ".arpa" (e.g.,
                    "sacrificial-nameserver.arpa"), or as a contracted sinkhole service by ICANN or
                    other DNS ecosystem actors. This practice has not been observed in use.</t>
                <section anchor="new-service-pros" title="Practice Benefits">
                    <t>This is a convenient for the deleting EPP client. The deleting EPP client is
                        not required to
                        maintain an authoritative DNS service or receive traffic. The associated
                        domains are not vulnerable to hijacking.
                        This would provide an well-understood, industry-standard solution, allowing
                        registrars and registrants to easily identify associated domains that have
                        been affected. Infrastructure operators could monitor traffic to identify
                        affected associated domains that result in significant traffic and attempt
                        to contact registrars and registrants.
                        Economies of scale would allow reduced overall costs to the industry (in
                        contrast to each client running an independent service).</t>
                </section>
                <section anchor="new-service-cons" title="Practice Detriments">
                    <t>Some entity must maintain the infrastructure for the service.</t>
                </section>
            </section>
            <section anchor="explicit-delete" title="Allow Explicit Delete of Host Objects">
                <t>The recommendations in RFC 5731 <xref target="RFC5731" /> are intended to
                    maintain consistency. However, they are not requirements. EPP servers may relax
                    their constraints and allow sponsoring clients to delete host objects and
                    disassociate them from domain objects sponsored by other clients. 
                    This practice has been observed in use.
                </t>
                <section anchor="explicit-delete-pros" title="Practice Benefits">
                    <t>
                        This is a convenient for the deleting EPP client. The deleting EPP client is
                        not required to
                        maintain an authoritative DNS service or receive traffic. The associated
                        domains are not vulnerable to hijacking.
                    </t>
                </section>
                <section anchor="explicit-delete-cons" title="Practice Detriments">
                    <t>This could
                        result in domains with no remaining name servers being removed from the zone
                        or
                        domains with only one remaining name server.
                        Deletions could potentially affect large numbers of associated domains,
                        placing strain on domain registries.
                    </t>
                </section>
            <section anchor="options-allow-delete"
                title="Options for Allowed Delete of Associated Host Objects">
                <t>As noted previously, EPP servers can allow clients to delete host objects and
                    disassociate them from domain objects. </t>
                <section anchor="explicit-deletion-request" title="Explicit Deletion Request">
                    <t>EPP servers may require that the EPP client explicitly request
                        the deletion of the host object before taking this action.
                        This practice has not been observed in use.
                    </t>
                    <section anchor="explicit-deletion-request-pros" title="Practice Benefits">
                        <t>
                            This would give EPP clients greater flexibility with respect to
                            deletion. For example, they may choose only to exercise deletions that
                            have no impact on other clients.
                        </t>
                    </section>
                    <section anchor="explicit-deletion-request-cons" title="Practice Detriments">
                        <t>
                            This change would require additional development on the part of EPP
                            servers and clients. It may only be relevant if the EPP client is also
                            provided additional deletion details about the affected domains. 
                        </t>
                    </section>
                </section>
                <section anchor="additional-deletion-details" title="Additional Deletion Details">
                    <t>The EPP server may provide the deleting EPP client with additional details of the affected
                        objects. The deleting EPP client may receive a response (e.g., using msg, reason, msgQ elements of the EPP response <xref target="RFC5730" />)
                        that deletion of the host object would affect
                        domain objects sponsored by another client and may receive details about those objects (e.g., using the EPP poll command). 
                        This practice has not been observed in use.
                    </t>
                    <section anchor="additional-deletion-details-pros" title="Practice Benefits">
                        <t>
                            The deleting EPP client would be able to better understand and assess
                            the potential harms of a host object deletion.
                            Depending on the content of the message, the deleting EPP client might
                            choose additional actions, such as delaying the deletion until manual
                            approval can be obtained, renaming the host objects, or informing
                            affected EPP clients.
                        </t>
                    </section>
                    <section anchor="additional-deletion-details-cons" title="Practice Detriments">
                        <t>
                            This change would require additional development on the part of EPP
                            servers and clients. There may be scalability concerns if large numbers
                            of domain objects are updated in a single transaction. The EPP server
                            must
                            determine the relevant information to provide for the EPP client's
                            assessment.
                        </t>
                    </section>
                </section>
                <section anchor="inform-affected-client" title="Inform Affected Clients">
                    <t> The sponsoring clients of affected domain objects may also be informed of
                        the change (e.g., through the EPP Change Poll extension <xref target="RFC8590" />).
                        This practice has not been observed in use.
                    </t>
                    <section anchor="inform-affected-client-pros" title="Practice Benefits">
                        <t>Updates would help achieve the goals of client-server data consistency
                            and minimal interruptions to resolution.
                            The sponsoring clients of affected domain objects would be able to
                            update their database to reflect the change and would be able to inform
                            the domain's registrant.
                            The sponsoring clients could also quickly or automatically update the
                            affected domains to use another authoritative host. </t>
                    </section>
                    <section anchor="inform-affected-client-cons" title="Practice Detriments">
                        <t>
                            This change would require additional development on the part of EPP
                            servers and clients. There may be scalability concerns if large numbers
                            of domain objects are updated in a single transaction.
                        </t>
                    </section>
                </section>
                <section anchor="delete-with-restore" title="Allow Explicit Delete of Domain with Restore Capability">
                    <t>
                        EPP servers can allow for the explicit deletion of a domain with
                        subordinate host objects associated with other domains as long as the
                        associations can be restored by the &lt;restore&gt; operation described in RFC 3915 <xref target="RFC3915" />.
                        Allowing for the explicit deletion of a domain name that performs a
                        cascade purge of the subordinate host objects and the association
                        with other domains is unrecoverable and would be a risk to malicious
                        or accidental actions.  Instead of purging the subordinate hosts
                        objects, the server can keep them with the "pendingDelete" status and
                        keep the associations with other domains, but they will not be
                        available in DNS.  This will provide for a preview of the operation
                        that is restorable.  If the action was malicious, accidental, or had
                        negative side effects, the domain, its subordinate host objects, and
                        the associations with other domains can be restored with the
                        &lt;restore&gt; operation in RFC 3915 during the redemption period.  The
                        purge of the domain will correspond with the purging of the
                        subordinate hosts objects and the associations at the end of the
                        pending delete period in RFC 3915.  Due to the potential large
                        number of associations, the server can asynchronously update (e.g.,
                        add and remove from DNS) and purge the associations.
                        This practice has not been observed in use.
                    </t>
                    <section anchor="delete-with-restore-pros" title="Practice Benefits">
                        <t>
                            This practice enables the clients to directly delete the domains that
                            they need to without the requirement to rename the subordinate host
                            objects, since the server will fully support restoration of the
                            associations during the redemption period.  The management of the
                            domain and the subordinate hosts will be simplified for the client by
                            supporting the explicit deletion of the domain with the capability of
                            mitigating a destructive malicious or accidental action.
                        </t>
                    </section>
                    <section anchor="delete-with-restore-cons" title="Practice Detriments">
                        <t>
                            By making it easier for a client to explicitly delete a domain having subordinates hosts
                            with associations, there is higher risk of inadvertent side effects in a single delete command.
                            There is existing risk in EPP of inadvertent side effects, such as adding the "clientHold"
                            status to the domain that will impact the DNS resolution of the subordinate hosts and the
                            associated delegations. The ability to easily rollback the command is key to minimize the
                            impact of the side effects. Another issue is the potential size of the database transaction to
                            disable, re-enable, or purge the subordinate host associations, since there is no limit with the
                            number of associations to delegated domains. Servers can break-up the disable, re-enable, or purge
                            of the subordinate host associations into smaller transactions by implementing it asynchronously.
                        </t>
                    </section>
                </section>
            </section>
            </section>
            <section anchor="options-narrow-glue" title="Narrow Glue">
                <t>EPP servers can adopt a "narrow" glue policy to reduce the need for renaming or deletion
                of host objects.</t>
                <section anchor="options-narrow-glue-pros" title="Practice Benefits">
                    <t>While the adoption of narrow glue policy does not prevent creation of
                        sacrificial nameservers, it reduces the number of
                        domains that may be exposed as a result of a domain object deletion.
                        Furthermore, the narrow glue policy makes explicit
                        the dependence and thus prevents domains from implicitly relying on glue
                        records in the parent zone thereby limiting the
                        potential impact of allowing these domains to be deleted and reducing the
                        overall state stored in the EPP server.</t>
                </section>
                <section anchor="options-narrow-glue-cons" title="Practice Detriments">
                    <t>The adoption of narrow glue policy can require significant updates
                        to EPP server and client implementations.
                        Domains that are configured to implicitly depend on the wide glue may not
                        resolve correctly on removal of the wide
                        glue. Moreover, the removal of glue can affect the resolution performance of
                        domains that previously used the wide
                        glue but now need additional queries to be resolved.</t>
                </section>
            </section>
        </section>
        <section anchor="recommendations" title="Best Practice Recommendations">
            <section anchor="recommendations-current" title="Best Current Practices">
                <t>
                    EPP clients MAY rename the host object to be deleted to a
                    sacrificial name server host object maintained by the client.  This
                    requires that the client maintain the registration of the sacrificial
                    name server's superordinate domain.  The client may consider long
                    registration periods and the use of registrar and registry lock
                    services to maintain and protect the superordinate domain and the
                    host object.  Failures to maintain these registrations have allowed
                    domain hijacks [risky-bizness].
                </t>
                <t>
                    The sacrificial name server should run a DNS resolution service
                    capable of responding with an authoritative non-error, non-failure
                    response for requests made for associated domains.  The service
                    SHOULD provide responses that indicate problems with a domain's
                    delegation, such as non-existence or include controlled interruption
                    IP addresses <xref target="RFC8023" />.
                </t>
            </section>
            <section anchor="recommendations-proposed" title="Best Proposed Practices">
                <section anchor="recommendations-proposed-delete-safely" title="Safe Host Deletion">
                    <t>
                        EPP servers would allow clients to explicitly delete hosts with dependent domains.
                        Hosts would be deleted with restore capability, as explained above.
                    </t>
                </section>
                <section anchor="recommendations-proposed-rename-reserved" title="Rename to New Reserved TLD">
                    <t>
                        Clients would rename hosts to use a new reserved TLD (e.g., .sacrificial).
                        Use of this TLD would communicate the client's intention to create a sacrificial host.
                        Resolver software could safely ignore the TLD.
                        Requests to the root for this TLD would not result in DNS failures.
                    </t>
                </section>
            </section>
        </section>

        <section anchor="IANA" title="IANA Considerations">
            <t>This document does not contain any instructions for IANA.</t>
        </section>

        <section anchor="Security" title="Security Considerations">
            <t>This document describes guidance found in RFCs 5731 and 5732 regarding the deletion
                of domain and host objects by EPP clients. That guidance sometimes requires that
                host objects be renamed such that they become "external" hosts (see Section 1.1 of
                RFC 5731 <xref target="RFC5731" />) in order to meet an EPP server's requirements
                for host object disassociation prior to domain object deletion. Host object renaming
                can introduce a risk of DNS resolution hijacking under certain operational
                conditions. This document provides guidance that is intended to reduce the risk of
                DNS resolution failure or hijacking as part of the process of deleting EPP domain or
                host objects.</t>

            <t>Child domains that depend on host objects associated with domain objects sponsored by
                another
                EPP client for DNS resolution may be protected from hijacking through the use of
                DNSSEC. Their
                resolution may be protected from the effects of deletion by using host objects
                associated with
                multiple domain objects. DNSSEC and multiple host objects may interfere with the use
                of controlled
                interruption IP addresses to alert registrants to DNS changes. EPP clients can
                periodically scan
                sponsored domains for association with sacrificial name servers and alert end users
                concerning those domains.</t>
        </section>
        <section anchor="acks" title="Acknowledgments">
            <t>The authors would like to thank the following people for their contributions to this
                document: James Gould, James Mitchell, Matthew Thomas, Peter
                Thomassen.</t>
        </section>
    </middle>
    <back>
        <references>
            <name>References</name>
            <references>
                <name>Normative References</name>
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5730.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5731.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5732.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6761.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9476.xml" />
            </references>
            <references>
                <name>Informative References</name>
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3915.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6305.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7535.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8023.xml" />
                <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8590.xml" />
                <reference anchor="risky-bizness" target="https://doi.org/10.1145/3487552.3487816">
                    <front>
                        <title>Risky BIZness: Risks Derived from Registrar Name Management</title>
                        <author fullname="Gautam Akiwate" initials="G." surname="Akiwate" />
                        <author fullname="Stefan Savage" initials="S." surname="Savage" />
                        <author fullname="Geoffrey M. Voelker" initials="G." surname="Voelker" />
                        <author fullname="KC Claffy" initials="K." surname="Claffy" />
                        <date year="2021" month="Nov" />
                    </front>
                </reference>
                <reference anchor="risky-bizness-irtf"
                    target="https://datatracker.ietf.org/doc/slides-115-irtfopen-risky-bizness-risks-derived-from-registrar-name-management/">
                    <front>
                        <title>Risky BIZness: Risks Derived from Registrar Name Management</title>
                        <author fullname="Gautam Akiwate" initials="G." surname="Akiwate" />
                        <author fullname="Stefan Savage" initials="S." surname="Savage" />
                        <author fullname="Geoffrey M. Voelker" initials="G." surname="Voelker" />
                        <author fullname="KC Claffy" initials="K." surname="Claffy" />
                        <date year="2022" month="Nov" />
                    </front>
                </reference>
                <xi:include
                    href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dnsop-caching-resolution-failures.xml" />
            </references>
        </references>
        <section title="Change Log">
            <t>RFC Editor: Please remove this section before publication.</t>
            <t>This section lists substantial changes to the document as it is being worked on.</t>
            <t>00:</t>
            <ol>
                <li>Initial version.</li>
            </ol>
            <t>01:</t>
            <ol>
                <li>Restructured practice sections to describe pros and cons, combined "allow delete" practices.</li>
                <li>Added Gautam Akiwate as co-author.</li>
                <li>Added narrow/wide glue explanation.</li>
            </ol>
            <t>02:</t>
            <ol>
                <li>TBD</li>
            </ol>
        </section>
    </back>
</rfc>